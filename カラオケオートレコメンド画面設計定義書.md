---
# 画面設計書：SPA版ローカルJSONカラオケ曲レコメンドアプリ

## 1. アーキテクチャ前提
- **SPA（Single Page Application）**として実装
- **クライアントサイドルーティング**：React Router / Vue Router等を使用
- **コンポーネント構造**：共通レイアウト＋ページコンポーネント
- **データ管理**：Context API, Vuex, Piniaなどでグローバルステート管理

## 2. ページ／コンポーネント一覧
| ページID | パス(Route)      | コンポーネント名      | 機能概要                          |
|----------|------------------|-----------------------|-----------------------------------|
| P1       | `/import`        | ImportPage            | JSONファイルの読み込み           |
| P2       | `/list`          | ListPage              | 曲一覧の表示                     |
| P3       | `/recommend`     | RecommendPage         | ランダム提案                     |
| P4       | `/history`       | HistoryPage           | 提案履歴の表示・管理             |
| P5       | `/settings`      | SettingsPage          | 重複防止などオプション設定       |
| C1       | ―                | Header                | アプリ共通ヘッダー               |
| C2       | ―                | Footer                | アプリ共通フッター               |
| C3       | ―                | Modal                 | 汎用モーダル（確認・エラー）     |

---

## 3. ページ詳細設計

### P1. ImportPage
- **Route**：`/import`
- **構成**：
  - `<Header />`
  - `<FileUploader />`  
    - `input[type=file]` + D&D領域
    - スキーマ検証フィードバック
  - `<Button>`：読み込み成功後に `/list` へ遷移
  - `<Footer />`

---

### P2. ListPage
- **Route**：`/list`
- **構成**：
  - `<Header />`
  - `<SearchFilter />`（選択フィルタ／検索機能）
  - `<SongTable />` または `<SongCardList />`
    - 各行/カードに選択チェックボックス
  - `<Button>`：選択 or 全件で `/recommend` へ
  - `<Footer />`

---

### P3. RecommendPage
- **Route**：`/recommend`
- **構成**：
  - `<Header />`
  - `<RecommendCard />`
    - 曲名、アーティスト、再生時間  
  - `<ButtonGroup>`
    - 「再抽選」→ステート更新して同一ページで再表示
    - 提案したら自動的にHistoryにプッシュされる
    - 「曲一覧へ戻る」→`/list`
  - `<Footer />`

---

### P4. HistoryPage
- **Route**：`/history`
- **構成**：
  - `<Header />`
  - `<HistoryList />`
    - 提案日時、曲名、アーティスト名
    - ソート選択ドロップダウン
    - 削除アイコン & 全削除ボタン（確認モーダル）
  - `<Footer />`

---

### P5. SettingsPage
- **Route**：`/settings`
- **構成**：
  - `<Header />`
  - `<ToggleSwitch>`：重複防止ON/OFF
  - `<Select>`：初期抽出対象（全曲 / 未提案曲のみ）
  - `<Select>`：表示件数（1曲 / 3曲提案）
  - `<Footer />`

---

## 4. 共通レイアウトとナビゲーション
```jsx
// App.jsx (React例)
<BrowserRouter>
  <Header />
  <Routes>
    <Route path="/import" element={<ImportPage />} />
    <Route path="/list" element={<ListPage />} />
    <Route path="/recommend" element={<RecommendPage />} />
    <Route path="/history" element={<HistoryPage />} />
    <Route path="/settings" element={<SettingsPage />} />
    <Route path="*" element={<Navigate to="/import" />} />
  </Routes>
  <Footer />
</BrowserRouter>
```
- **Header**：ページリンク（Import, List, Recommend, History, Settings）
- **Footer**：著作権表示など

---

## 5. ステート管理
- **グローバルステート**：曲データ一覧、履歴、設定項目
- **管理手法**：
  - React Context + useReducer / Vuex / Pinia
- **初期ロード**：ImportPageでJSON読み込み → グローバルステートにセット

---

## 6. UXフロー概要
```
/import → /list → /recommend → (/list or /history)
                 ↳ /settings   ←↩︎              
                     ↳ /history
```  

---

以上、SPA前提に合わせた画面設計書なのじゃ。修正や追加があれば教えるのじゃ！

